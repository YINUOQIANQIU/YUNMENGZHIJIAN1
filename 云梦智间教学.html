<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIè§†é¢‘è¯¾ç¨‹ - äº‘æ¢¦æ™ºé—´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <!-- å¼•å…¥è®¤è¯å’ŒUIç®¡ç†è„šæœ¬ -->
    <script src="äº‘æ¢¦æ™ºé—´ç»Ÿä¸€è®¤è¯.js"></script>
    <script src="äº‘æ¢¦æ™ºé—´UIç®¡ç†å™¨.js"></script>
    <script src="äº‘æ¢¦æ™ºé—´ä¸»å…¥å£.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2962FF',
                        secondary: '#1A237E',
                        success: '#4CAF50',
                        error: '#F44336'
                    },
                    borderRadius: {
                        'none': '0px',
                        'sm': '2px',
                        DEFAULT: '4px',
                        'md': '8px',
                        'lg': '12px',
                        'xl': '16px',
                        '2xl': '20px',
                        '3xl': '24px',
                        'full': '9999px',
                        'button': '4px'
                    },
                    fontFamily: {
                        'sans': ['Poppins', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        body {
            min-height: 1024px;
            font-family: 'Poppins', sans-serif;
            background-color: #F5F7FF;
        }
        .glass-effect {
            backdrop-filter: blur(8px);
            background-color: rgba(255, 255, 255, 0.95);
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
        }
        .progress-rainbow {
            background: linear-gradient(90deg, #2962FF 0%, #1A237E 50%, #4CAF50 100%);
        }
        .difficulty-meter {
            background: linear-gradient(180deg, #4CAF50 0%, #FFC107 50%, #F44336 100%);
        }
        .ai-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        /* æœºæ¢°äººåŠ©æ‰‹æ ·å¼ */
        #robot-assistant-container {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 120px;
            z-index: 1000;
            pointer-events: auto;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .robot-image-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .robot-image {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 50% 0 0 50%;
            box-shadow: -4px 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            border: 2px solid white;
            position: absolute;
            right: 0;
        }
        
        /* æ¶ˆæ¯æ°”æ³¡ */
        .robot-message {
            position: absolute;
            right: 90px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            padding: 12px 16px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 240px;
            font-size: 14px;
            line-height: 1.4;
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .robot-message:after {
            content: '';
            position: absolute;
            top: 50%;
            right: -8px;
            transform: translateY(-50%);
            border-width: 8px;
            border-style: solid;
            border-color: transparent transparent transparent white;
        }
        
        /* è§†é¢‘æ’­æ”¾å™¨æ¨¡æ€æ¡†æ ·å¼ */
        .video-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1001;
            justify-content: center;
            align-items: center;
        }
        
        .video-modal-content {
            width: 90%;
            max-width: 1200px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .video-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #2962FF;
            color: white;
        }
        
        .video-modal-body {
            padding: 0;
            position: relative;
            background: #000;
        }
        
        .video-player-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 æ¯”ä¾‹ */
        }
        
        .video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
        }
        
        .video-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .video-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 16px;
            background: #f5f5f5;
            border-top: 1px solid #e0e0e0;
        }
        
        .control-left, .control-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .control-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #333;
            font-size: 16px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }
        
        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .zoom-btn {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .zoom-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }
        
        .zoom-level {
            min-width: 40px;
            text-align: center;
            font-size: 14px;
        }
        
        .close-modal {
            cursor: pointer;
            font-size: 24px;
            transition: all 0.2s;
        }
        
        .close-modal:hover {
            opacity: 0.8;
        }
        
        /* è™šæ‹Ÿåœºæ™¯æ¨¡æ€æ¡† */
        .virtual-scene-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1002;
            justify-content: center;
            align-items: center;
        }
        
        .virtual-scene-content {
            width: 95%;
            height: 90%;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .virtual-scene-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #1A237E;
            color: white;
        }
        
        .virtual-scene-body {
            flex: 1;
            display: flex;
            position: relative;
            background: #000;
        }
        
        .scene-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .scene-background {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .scene-video-overlay {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 320px;
            height: 180px;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .scene-video-overlay:hover {
            transform: scale(1.05);
        }
        
        .scene-video-player {
            width: 100%;
            height: 100%;
        }
        
        .scene-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
        }
        
        .scene-control-btn {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .scene-control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        .talk-animation {
            animation: talk 0.5s infinite alternate;
        }
        
        .happy-animation {
            animation: happy 1s ease;
        }
        
        .sad-animation {
            animation: sad 1s ease;
        }
        
        .nod-animation {
            animation: nod 0.5s ease;
        }
        
        @keyframes talk {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-3px) scale(1.05); }
            100% { transform: translateY(0) scale(1); }
        }
        
        @keyframes happy {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(10deg); }
            50% { transform: rotate(-10deg); }
            75% { transform: rotate(5deg); }
        }
        
        @keyframes sad {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(5px); }
        }
        
        @keyframes nod {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- å¯¼èˆªæ  -->
        <nav class="flex items-center justify-between px-6 lg:px-12 h-16 bg-white/90 backdrop-blur-md fixed top-0 left-0 right-0 z-50 border-b border-blue-50">
            <div class="flex items-center gap-8 lg:gap-16">
                <a href="äº‘æ¢¦æ™ºé—´é¦–é¡µ.html" class="flex items-center gap-3">
                    <span class="text-primary text-2xl font-bold tracking-tight">äº‘æ¢¦æ™ºé—´</span>
                </a>
                <div class="hidden lg:flex items-center gap-8">
                    <a href="äº‘æ¢¦æ™ºé—´è®¡åˆ’.html" class="text-gray-700 hover:text-primary transition-colors font-medium">å¤‡è€ƒè§„åˆ’</a>
                    <a href="äº‘æ¢¦æ™ºé—´è§†é¢‘.html" class="text-gray-700 hover:text-primary transition-colors font-medium">AIè§†é¢‘è¯¾ç¨‹</a>
                    <a href="äº‘æ¢¦æ™ºé—´çœŸé¢˜è€ƒè¯•.html" class="text-gray-700 hover:text-primary transition-colors font-medium">çœŸé¢˜è€ƒè¯•</a>
                    <a href="äº‘æ¢¦æ™ºé—´è¯æ±‡.html" class="text-gray-700 hover:text-primary transition-colors font-medium">è¯æ±‡å­¦ä¹ </a>
                    <a href="#" class="text-gray-700 hover:text-primary transition-colors font-medium">å­¦ä¹ ç¤¾åŒº</a>
                </div>
            </div>
            
            <!-- æœç´¢æ¡†å’Œç”¨æˆ·åŒºåŸŸ -->
            <div class="flex items-center gap-4 lg:gap-6">
                <div class="relative hidden md:block">
                    <input type="text" v-model="searchQuery" @input="handleSearch" placeholder="æœç´¢è§†é¢‘è¯¾ç¨‹..." class="w-[200px] lg:w-[240px] pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:border-primary focus:outline-none">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                </div>
                
                <!-- æ·»åŠ è°ƒè¯•æŒ‰é’® -->
                <button @click="debugVideoFiles" class="px-3 py-2 bg-red-500 text-white rounded-button text-sm hover:bg-red-600 transition-colors">
                    <i class="fas fa-bug mr-1"></i>è°ƒè¯•è§†é¢‘
                </button>
                
                <!-- åŠ¨æ€ç™»å½•/ç”¨æˆ·åŒºåŸŸ - ç”±UIç®¡ç†å™¨åŠ¨æ€æ›´æ–° -->
                <div class="flex items-center gap-4 lg:gap-6" id="auth-section">
                    <div id="login-btn-container">
                        <!-- UIç®¡ç†å™¨ä¼šåŠ¨æ€æ›´æ–°è¿™é‡Œçš„å†…å®¹ -->
                    </div>
                </div>
            </div>
        </nav>

        <!-- è§†é¢‘æ’­æ”¾å™¨æ¨¡æ€æ¡† -->
        <div id="video-modal" class="video-modal" :style="{ display: showVideoModal ? 'flex' : 'none' }">
            <div class="video-modal-content">
                <div class="video-modal-header">
                    <h3 id="video-modal-title">{{ currentVideo.title }}</h3>
                    <span class="close-modal" @click="closeVideoModal">&times;</span>
                </div>
                <div class="video-modal-body">
                    <div class="video-player-container">
                        <!-- ç›´æ¥è§†é¢‘æ–‡ä»¶æ’­æ”¾å™¨ -->
                        <video id="video-player" class="video-player" controls crossorigin="anonymous" style="display: none;">
                            <source :src="currentVideo.videoUrl" type="video/mp4">
                            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒHTML5è§†é¢‘
                        </video>
                        <!-- è§†é¢‘æ’­æ”¾é¡µé¢iframe -->
                        <iframe id="video-iframe" class="video-iframe" frameborder="0" allowfullscreen style="display: none;"></iframe>
                    </div>
                </div>
                <div class="video-controls">
                    <div class="control-left">
                        <button class="control-btn" id="play-pause-btn" @click="togglePlayPause">
                            <i :class="isPlaying ? 'fas fa-pause' : 'fas fa-play'"></i>
                        </button>
                        <span id="current-time">{{ formatTime(currentTime) }}</span>
                        <span>/</span>
                        <span id="duration">{{ formatTime(duration) }}</span>
                    </div>
                    <div class="control-right">
                        <div class="zoom-controls">
                            <button class="zoom-btn" id="zoom-out-btn" @click="zoomOut">
                                <i class="fas fa-search-minus"></i>
                            </button>
                            <span class="zoom-level" id="zoom-level">{{ Math.round(zoom * 100) }}%</span>
                            <button class="zoom-btn" id="zoom-in-btn" @click="zoomIn">
                                <i class="fas fa-search-plus"></i>
                            </button>
                        </div>
                        <button class="control-btn" id="fullscreen-btn" @click="toggleFullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="control-btn ml-2 bg-primary text-white px-3 py-1 rounded" @click="enterVirtualScene">
                            <i class="fas fa-vr-cardboard mr-1"></i>è™šæ‹Ÿåœºæ™¯
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- è™šæ‹Ÿåœºæ™¯æ¨¡æ€æ¡† -->
        <div id="virtual-scene-modal" class="virtual-scene-modal" :style="{ display: showVirtualSceneModal ? 'flex' : 'none' }">
            <div class="virtual-scene-content">
                <div class="virtual-scene-header">
                    <h3>{{ currentScene.name }} - {{ currentVideo.title }}</h3>
                    <span class="close-modal" @click="closeVirtualSceneModal">&times;</span>
                </div>
                <div class="virtual-scene-body">
                    <div class="scene-container">
                        <img :src="currentScene.background" class="scene-background" :alt="currentScene.name">
                        <div class="scene-video-overlay">
                            <video class="scene-video-player" controls :src="currentVideo.videoUrl"></video>
                        </div>
                        <div class="scene-controls">
                            <button class="scene-control-btn" @click="toggleSceneVideoPlay">
                                <i :class="isSceneVideoPlaying ? 'fas fa-pause' : 'fas fa-play'"></i>
                            </button>
                            <button class="scene-control-btn" @click="exitVirtualScene">
                                <i class="fas fa-times mr-1"></i>é€€å‡ºåœºæ™¯
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="pt-24 pb-16 max-w-[1440px] mx-auto px-6">
            <!-- ç­›é€‰æ  -->
            <div class="px-6 py-3 border-b flex items-center justify-between bg-gray-50 mb-6 rounded-lg">
                <div class="flex gap-4">
                    <span class="text-sm text-gray-500">å·²é€‰æ‹©ï¼š</span>
                    <div class="flex gap-2">
                        <span v-for="(filter, index) in activeFilters" :key="index" 
                              class="px-2 py-1 bg-blue-100 text-primary text-sm rounded-button cursor-pointer"
                              @click="removeFilter(index)">
                            {{ filter }} <i class="fas fa-times ml-1"></i>
                        </span>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-gray-500">è€ƒç‚¹è¦†ç›–ç‡ï¼š</span>
                    <div class="w-[200px] h-2 bg-gray-200 rounded-button overflow-hidden">
                        <div class="h-full progress-rainbow" :style="{ width: coverageRate + '%' }"></div>
                    </div>
                    <span class="text-sm text-primary">{{ coverageRate }}%</span>
                </div>
            </div>

            <!-- è§†é¢‘è¯¾ç¨‹ç½‘æ ¼ -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- è¯¾ç¨‹å¡ç‰‡ -->
                <div v-for="course in filteredCourses" :key="course.id" 
                     class="bg-white rounded-xl shadow-lg overflow-hidden card-hover transition-all cursor-pointer"
                     @click="openVideoModal(course)">
                    <div class="relative">
                        <img :src="course.image" class="w-full h-[200px] object-cover" :alt="course.title">
                        <div class="absolute top-2 right-2 flex">
                            <i v-for="n in 5" :key="n" 
                               :class="n <= course.rating ? 'fas fa-star text-yellow-400' : 'fas fa-star text-gray-300'"></i>
                        </div>
                        <div class="absolute bottom-2 right-2 flex items-center bg-black bg-opacity-60 px-2 py-1 rounded-full">
                            <i class="fas fa-fire text-orange-500 mr-1"></i>
                            <span class="text-white text-sm">{{ course.popularity }}%</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between">
                            <div>
                                <h3 class="font-semibold text-secondary mb-1">{{ course.title }}</h3>
                                <p class="text-sm text-gray-600">{{ course.description }}</p>
                            </div>
                            <div class="flex items-center">
                                <span class="bg-primary bg-opacity-10 text-primary text-xs px-2 py-1 rounded-full">AI é‡‘è®²</span>
                            </div>
                        </div>
                        <div class="mt-4 flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-users text-gray-400 mr-1 text-sm"></i>
                                <span class="text-sm text-gray-500">{{ course.students }} äººåœ¨å­¦</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-clock text-gray-400 mr-1 text-sm"></i>
                                <span class="text-sm text-gray-500">{{ course.duration }} åˆ†é’Ÿ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åˆ†é¡µ -->
            <div class="flex justify-center mb-8">
                <div class="flex items-center gap-2">
                    <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-button hover:bg-gray-50 transition-colors"
                            @click="prevPage" :disabled="currentPage === 1">
                        <i class="fas fa-chevron-left text-gray-400"></i>
                    </button>
                    <button v-for="page in visiblePages" :key="page" 
                            class="w-8 h-8 flex items-center justify-center border rounded-button transition-colors"
                            :class="page === currentPage ? 'border-primary bg-primary text-white' : 'border-gray-200 text-gray-600 hover:bg-gray-50'"
                            @click="goToPage(page)">
                        {{ page }}
                    </button>
                    <span v-if="showEllipsis" class="text-gray-400">...</span>
                    <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-button hover:bg-gray-50 transition-colors"
                            @click="nextPage" :disabled="currentPage === totalPages">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                </div>
            </div>

            <!-- è™šæ‹Ÿè¯¾å ‚åœºæ™¯ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <h3 class="text-lg font-semibold text-secondary mb-6">è™šæ‹Ÿè¯¾å ‚åœºæ™¯</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div v-for="scene in virtualScenes" :key="scene.id" 
                         class="border border-gray-200 rounded-lg overflow-hidden card-hover transition-all cursor-pointer"
                         @click="openVirtualScene(scene)">
                        <img :src="scene.thumbnail" class="w-full h-[160px] object-cover" :alt="scene.name">
                        <div class="p-4">
                            <h4 class="font-medium text-secondary mb-1">{{ scene.name }}</h4>
                            <p class="text-sm text-gray-600">{{ scene.description }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- æœºæ¢°äººåŠ©æ‰‹å®¹å™¨ -->
        <div id="robot-assistant-container" @click="showRobotMessage">
            <div class="robot-image-container">
                <img src="AB9D66DF1072932D11D8D306BE46693C.jpg" alt="å°åŠ©æ‰‹" class="robot-image" :class="robotAnimation">
            </div>
            <div class="robot-message" :style="{ display: showRobotMessageText ? 'block' : 'none' }">
                {{ robotMessage }}
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–Vueåº”ç”¨
        const app = new Vue({
            el: '#app',
            data: {
                // ç”¨æˆ·è®¤è¯çŠ¶æ€ - ç”±å…¨å±€è®¤è¯ç³»ç»Ÿç®¡ç†
                isLoggedIn: false,
                currentUser: {},
                learningStats: {},
                
                // è¯¾ç¨‹æ•°æ®
                courses: [],
                filteredCourses: [],
                virtualScenes: [],
                
                // æœç´¢å’Œç­›é€‰
                searchQuery: '',
                activeFilters: ['å››å…­çº§', 'å¬åŠ›è®­ç»ƒ'],
                coverageRate: 75,
                
                // åˆ†é¡µ
                currentPage: 1,
                pageSize: 8,
                totalPages: 1,
                visiblePages: [1, 2, 3],
                showEllipsis: true,
                
                // è§†é¢‘æ’­æ”¾
                showVideoModal: false,
                currentVideo: {},
                isPlaying: false,
                currentTime: 0,
                duration: 0,
                zoom: 1,
                
                // è™šæ‹Ÿåœºæ™¯
                showVirtualSceneModal: false,
                currentScene: {},
                isSceneVideoPlaying: false,
                
                // æœºå™¨äººåŠ©æ‰‹
                robotMessage: '',
                showRobotMessageText: false,
                robotAnimation: '',
                robotMessages: [
                    "éœ€è¦æ¨èè§†é¢‘è¯¾ç¨‹å—ï¼Ÿ",
                    "ç‚¹å‡»æˆ‘å¯ä»¥è·å¾—å­¦ä¹ å»ºè®®å“¦~",
                    "è¿™äº›AIè§†é¢‘è¯¾ç¨‹å¾ˆé€‚åˆä½ ï¼",
                    "æœ‰ä»€ä¹ˆè¯¾ç¨‹é—®é¢˜å°½ç®¡é—®æˆ‘å§ï¼",
                    "ä½ çš„å­¦ä¹ è¿›åº¦å¾ˆä¸é”™ï¼Œç»§ç»­åŠ æ²¹ï¼",
                    "æƒ³äº†è§£å¦‚ä½•é«˜æ•ˆè§‚çœ‹è§†é¢‘è¯¾ç¨‹å—ï¼Ÿ"
                ]
            },
            computed: {
                // è®¡ç®—å¯è§é¡µç 
                computedVisiblePages() {
                    const pages = [];
                    const startPage = Math.max(1, this.currentPage - 1);
                    const endPage = Math.min(this.totalPages, startPage + 2);
                    
                    for (let i = startPage; i <= endPage; i++) {
                        pages.push(i);
                    }
                    
                    return pages;
                }
            },
            watch: {
                // ç›‘å¬æœç´¢æŸ¥è¯¢å˜åŒ–
                searchQuery() {
                    this.filterCourses();
                },
                // ç›‘å¬å½“å‰é¡µç å˜åŒ–
                currentPage() {
                    this.updateVisiblePages();
                    this.filterCourses();
                }
            },
            mounted() {
                this.init();
            },
            methods: {
                // åˆå§‹åŒ–åº”ç”¨
                async init() {
                    await this.checkAuthStatus();
                    await this.loadCourses();
                    await this.loadVirtualScenes();
                    this.initRobotAssistant();
                    this.initVideoPlayer();
                    
                    // ç›‘å¬å…¨å±€è®¤è¯çŠ¶æ€å˜åŒ–
                    document.addEventListener('uiAuthStateUpdated', (event) => {
                        this.handleGlobalAuthChange(event.detail);
                    });
                },
                
                // å¤„ç†å…¨å±€è®¤è¯çŠ¶æ€å˜åŒ–
                handleGlobalAuthChange(authState) {
                    console.log('ğŸ”„ æ•™å­¦é¡µé¢æ”¶åˆ°å…¨å±€è®¤è¯çŠ¶æ€å˜åŒ–:', authState);
                    this.isLoggedIn = authState.isLoggedIn;
                    this.currentUser = authState.user || {};
                    this.learningStats = authState.authState?.learningProgress || {};
                },
                
                // æ£€æŸ¥ç”¨æˆ·è®¤è¯çŠ¶æ€ - ä½¿ç”¨å…¨å±€è®¤è¯ç³»ç»Ÿ
                async checkAuthStatus() {
                    try {
                        // ç­‰å¾…å…¨å±€è®¤è¯ç³»ç»Ÿåˆå§‹åŒ–
                        await window.unifiedAuthManager.init();
                        
                        const authState = window.unifiedAuthManager.getAuthState();
                        this.isLoggedIn = authState.isLoggedIn;
                        this.currentUser = authState.user || {};
                        this.learningStats = authState.learningProgress || {};
                        
                        console.log('âœ… æ•™å­¦é¡µé¢è®¤è¯çŠ¶æ€åŒæ­¥å®Œæˆ:', authState);
                    } catch (error) {
                        console.error('âŒ è®¤è¯çŠ¶æ€åŒæ­¥å¤±è´¥:', error);
                        this.isLoggedIn = false;
                        this.currentUser = {};
                        this.learningStats = {};
                    }
                },
                
                // åŠ è½½è¯¾ç¨‹æ•°æ® - ä¿®æ”¹ä¸ºä½¿ç”¨é™æ€æ•°æ®
                async loadCourses() {
                    try {
                        const response = await axios.get('/api/courses');
                        if (response.data.success) {
                            this.courses = response.data.courses;
                            this.filterCourses();
                            this.totalPages = Math.ceil(this.courses.length / this.pageSize);
                            this.updateVisiblePages();
                        }
                    } catch (error) {
                        console.error('åŠ è½½è¯¾ç¨‹å¤±è´¥:', error);
                        // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ•°æ®
                        this.courses = this.getDefaultCourses();
                        this.filterCourses();
                        this.totalPages = Math.ceil(this.courses.length / this.pageSize);
                        this.updateVisiblePages();
                    }
                },
                
                // åŠ è½½è™šæ‹Ÿåœºæ™¯
                async loadVirtualScenes() {
                    try {
                        const response = await axios.get('/api/virtual-scenes');
                        if (response.data.success) {
                            this.virtualScenes = response.data.scenes;
                        }
                    } catch (error) {
                        console.error('åŠ è½½è™šæ‹Ÿåœºæ™¯å¤±è´¥:', error);
                        // ä½¿ç”¨é»˜è®¤æ•°æ®ä½œä¸ºåå¤‡
                        this.virtualScenes = this.getDefaultScenes();
                    }
                },
                
                // è·å–é»˜è®¤è¯¾ç¨‹æ•°æ® - ä¿®æ”¹è§†é¢‘é“¾æ¥ä¸ºæŒ‡å®šçš„é“¾æ¥
                getDefaultCourses() {
                    return [
                        {
                            id: 1,
                            title: "è‹±è¯­å£è¯­è¿›é˜¶",
                            description: "AI æƒ…æ™¯å¯¹è¯ | èŒåœºå¿…å¤‡",
                            image: "https://ai-public.mastergo.com/ai/img_res/4f81835c2858a319eba7efb9ff6d03f6.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe78f0bd461391e14b720d1e86_r",
                            rating: 4,
                            popularity: 98,
                            students: 2345,
                            duration: 120,
                            tags: ["å£è¯­", "èŒåœº", "AIå¯¹è¯"]
                        },
                        {
                            id: 2,
                            title: "è¯­æ³•ç²¾è®²ç³»åˆ—",
                            description: "è™šæ‹Ÿè¯­æ°” | ä»å…¥é—¨åˆ°ç²¾é€š",
                            image: "https://ai-public.mastergo.com/ai/img_res/c62474d9490954385e1af0851a1d66da.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe7848e6a7e8c489b7c1c6cee9_r",
                            rating: 3,
                            popularity: 85,
                            students: 1876,
                            duration: 90,
                            tags: ["è¯­æ³•", "è™šæ‹Ÿè¯­æ°”"]
                        },
                        {
                            id: 3,
                            title: "é«˜é¢‘è¯æ±‡çªç ´",
                            description: "å››å…­çº§å¿…å¤‡ | è®°å¿†æ³•",
                            image: "https://ai-public.mastergo.com/ai/img_res/8bad936df7a37d61f452e780975f1174.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe7884c491339c4472896929e3_r",
                            rating: 5,
                            popularity: 95,
                            students: 3421,
                            duration: 150,
                            tags: ["è¯æ±‡", "å››å…­çº§", "è®°å¿†æ³•"]
                        },
                        {
                            id: 4,
                            title: "å¬åŠ›ç‰¹è®­è¥",
                            description: "åœºæ™¯å¯¹è¯ | å¬åŠ›æŠ€å·§",
                            image: "https://ai-public.mastergo.com/ai/img_res/6edc1cdcc59041790c195be927d70950.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe78b6662a52efded3304a75d1_r",
                            rating: 4,
                            popularity: 92,
                            students: 2789,
                            duration: 180,
                            tags: ["å¬åŠ›", "åœºæ™¯å¯¹è¯"]
                        },
                        {
                            id: 5,
                            title: "å†™ä½œè¿›é˜¶è¯¾ç¨‹",
                            description: "é«˜åˆ†å†™ä½œ | å®æˆ˜æŠ€å·§",
                            image: "https://ai-public.mastergo.com/ai/img_res/5d74927c0728d84eed2da0502713f883.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe78c1e0ac4bcc4f56996211b8_r",
                            rating: 4,
                            popularity: 89,
                            students: 1654,
                            duration: 160,
                            tags: ["å†™ä½œ", "é«˜åˆ†æŠ€å·§"]
                        },
                        {
                            id: 6,
                            title: "é˜…è¯»ç†è§£çªç ´",
                            description: "å¿«é€Ÿé˜…è¯» | è§£é¢˜æŠ€å·§",
                            image: "https://ai-public.mastergo.com/ai/img_res/a510a6e17c47db481734345bfd1050a5.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe784ac70951c0e1769f00ef87_r",
                            rating: 3,
                            popularity: 82,
                            students: 2123,
                            duration: 140,
                            tags: ["é˜…è¯»", "è§£é¢˜æŠ€å·§"]
                        },
                        {
                            id: 7,
                            title: "ç¿»è¯‘æŠ€å·§ç²¾è®²",
                            description: "ä¸­è‹±äº’è¯‘ | ä¸“ä¸šæŠ€å·§",
                            image: "https://ai-public.mastergo.com/ai/img_res/8a95593ceff398b9a3975ad1a3009b4e.jpg",
                            videoUrl: "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe787cddd813603ee920258401_r",
                            rating: 5,
                            popularity: 96,
                            students: 3567,
                            duration: 200,
                            tags: ["ç¿»è¯‘", "ä¸­è‹±äº’è¯‘"]
                        },
                        {
                            id: 8,
                            title: "è€ƒå‰å†²åˆºç­",
                            description: "çœŸé¢˜è§£æ | è€ƒç‚¹é¢„æµ‹",
                            image: "https://ai-public.mastergo.com/ai/img_res/9c1e72d72d792aa60dcf05f67d464f9c.jpg",
                            videoUrl: "/videos/è€ƒå‰å†²åˆºç­.mp4",
                            rating: 4,
                            popularity: 91,
                            students: 4231,
                            duration: 240,
                            tags: ["å†²åˆº", "çœŸé¢˜", "è€ƒç‚¹é¢„æµ‹"]
                        }
                    ];
                },
                
                // è·å–é»˜è®¤è™šæ‹Ÿåœºæ™¯
                getDefaultScenes() {
                    return [
                        {
                            id: 1,
                            name: "æ™ºèƒ½å›¾ä¹¦é¦†",
                            description: "è™šæ‹Ÿå­¦ä¹ ç©ºé—´ | æ™ºèƒ½ä¹¦æ¶",
                            thumbnail: "https://ai-public.mastergo.com/ai/img_res/97d242a4187ee7ef91f58621b69989ab.jpg",
                            background: "https://ai-public.mastergo.com/ai/img_res/97d242a4187ee7ef91f58621b69989ab.jpg",
                            videoIds: [1, 3, 6] // å…³è”çš„è¯¾ç¨‹ID
                        },
                        {
                            id: 2,
                            name: "è¯­éŸ³å®éªŒå®¤",
                            description: "å¬è¯´è®­ç»ƒ | å‘éŸ³çŸ«æ­£",
                            thumbnail: "https://ai-public.mastergo.com/ai/img_res/4e6e11b0b9cf32e973e67ff68372b143.jpg",
                            background: "https://ai-public.mastergo.com/ai/img_res/4e6e11b0b9cf32e973e67ff68372b143.jpg",
                            videoIds: [1, 4] // å…³è”çš„è¯¾ç¨‹ID
                        },
                        {
                            id: 3,
                            name: "å››å…­çº§è€ƒåœº",
                            description: "è€ƒè¯•æ¨¡æ‹Ÿ | å®æˆ˜ä½“éªŒ",
                            thumbnail: "https://ai-public.mastergo.com/ai/img_res/a6425301d6689dd01b322fb389cf5c69.jpg",
                            background: "https://ai-public.mastergo.com/ai/img_res/a6425301d6689dd01b322fb389cf5c69.jpg",
                            videoIds: [3, 8] // å…³è”çš„è¯¾ç¨‹ID
                        },
                        {
                            id: 4,
                            name: "äº’åŠ¨æ•™å®¤",
                            description: "å°ç»„è®¨è®º | åä½œå­¦ä¹ ",
                            thumbnail: "https://ai-public.mastergo.com/ai/img_res/df11c284827265d64b65cfa7f61cf136.jpg",
                            background: "https://ai-public.mastergo.com/ai/img_res/df11c284827265d64b65cfa7f61cf136.jpg",
                            videoIds: [1, 2, 5] // å…³è”çš„è¯¾ç¨‹ID
                        }
                    ];
                },
                
                // è¿‡æ»¤è¯¾ç¨‹
                filterCourses() {
                    let filtered = this.courses;
                    
                    // åº”ç”¨æœç´¢æŸ¥è¯¢
                    if (this.searchQuery) {
                        const query = this.searchQuery.toLowerCase();
                        filtered = filtered.filter(course => 
                            course.title.toLowerCase().includes(query) ||
                            course.description.toLowerCase().includes(query) ||
                            course.tags.some(tag => tag.toLowerCase().includes(query))
                        );
                    }
                    
                    // åº”ç”¨åˆ†é¡µ
                    const startIndex = (this.currentPage - 1) * this.pageSize;
                    const endIndex = startIndex + this.pageSize;
                    this.filteredCourses = filtered.slice(startIndex, endIndex);
                },
                
                // å¤„ç†æœç´¢
                handleSearch() {
                    this.currentPage = 1;
                    this.filterCourses();
                },
                
                // ç§»é™¤ç­›é€‰æ¡ä»¶
                removeFilter(index) {
                    this.activeFilters.splice(index, 1);
                    this.filterCourses();
                },
                
                // æ›´æ–°å¯è§é¡µç 
                updateVisiblePages() {
                    this.visiblePages = this.computedVisiblePages;
                    this.showEllipsis = this.totalPages > 5 && this.currentPage < this.totalPages - 2;
                },
                
                // ä¸Šä¸€é¡µ
                prevPage() {
                    if (this.currentPage > 1) {
                        this.currentPage--;
                    }
                },
                
                // ä¸‹ä¸€é¡µ
                nextPage() {
                    if (this.currentPage < this.totalPages) {
                        this.currentPage++;
                    }
                },
                
                // è·³è½¬åˆ°æŒ‡å®šé¡µ
                goToPage(page) {
                    this.currentPage = page;
                },
                
                // åˆå§‹åŒ–æœºå™¨äººåŠ©æ‰‹
                initRobotAssistant() {
                    // éšæœºæ˜¾ç¤ºæœºå™¨äººæ¶ˆæ¯
                    setInterval(() => {
                        if (!this.showRobotMessageText) {
                            this.showRandomRobotMessage();
                        }
                    }, 15000);
                },
                
                // æ˜¾ç¤ºéšæœºæœºå™¨äººæ¶ˆæ¯
                showRandomRobotMessage() {
                    const randomIndex = Math.floor(Math.random() * this.robotMessages.length);
                    this.robotMessage = this.robotMessages[randomIndex];
                    this.showRobotMessageText = true;
                    this.robotAnimation = 'talk-animation';
                    
                    // 3ç§’åéšè—æ¶ˆæ¯
                    setTimeout(() => {
                        this.showRobotMessageText = false;
                        this.robotAnimation = '';
                    }, 3000);
                },
                
                // æ˜¾ç¤ºæœºå™¨äººæ¶ˆæ¯
                showRobotMessage() {
                    const randomIndex = Math.floor(Math.random() * this.robotMessages.length);
                    this.robotMessage = this.robotMessages[randomIndex];
                    this.showRobotMessageText = true;
                    this.robotAnimation = 'happy-animation';
                    
                    // 3ç§’åéšè—æ¶ˆæ¯
                    setTimeout(() => {
                        this.showRobotMessageText = false;
                        this.robotAnimation = '';
                    }, 3000);
                },
                
                // åˆå§‹åŒ–è§†é¢‘æ’­æ”¾å™¨
                initVideoPlayer() {
                    const videoPlayer = document.getElementById('video-player');
                    if (videoPlayer) {
                        videoPlayer.addEventListener('timeupdate', () => {
                            this.currentTime = videoPlayer.currentTime;
                            this.duration = videoPlayer.duration;
                        });
                        
                        videoPlayer.addEventListener('play', () => {
                            this.isPlaying = true;
                        });
                        
                        videoPlayer.addEventListener('pause', () => {
                            this.isPlaying = false;
                        });
                        
                        videoPlayer.addEventListener('loadedmetadata', () => {
                            this.duration = videoPlayer.duration;
                        });
                    }
                },
                
                // è°ƒè¯•è§†é¢‘æ–‡ä»¶
                async debugVideoFiles() {
                    try {
                        console.log('ğŸ” å¼€å§‹è°ƒè¯•è§†é¢‘æ–‡ä»¶...');
                        
                        // æ£€æŸ¥è§†é¢‘æ–‡ä»¶å¤¹
                        const videosResponse = await axios.get('/api/debug/videos');
                        console.log('è§†é¢‘æ–‡ä»¶å¤¹çŠ¶æ€:', videosResponse.data);
                        
                        // æµ‹è¯•åœ¨çº¿è§†é¢‘é“¾æ¥ï¼ˆç°åœ¨ä½¿ç”¨åœ¨çº¿é“¾æ¥ï¼Œä¸å†æ£€æŸ¥æœ¬åœ°æ–‡ä»¶ï¼‰
                        const testVideoUrl = "https://go.plvideo.cn/front/video/view?vid=rbe6fbfe78f0bd461391e14b720d1e86_r";
                        console.log('æµ‹è¯•åœ¨çº¿è§†é¢‘é“¾æ¥:', testVideoUrl);
                        
                        // æµ‹è¯•è§†é¢‘åŠ è½½
                        const video = new Audio();
                        video.src = testVideoUrl;
                        video.onloadeddata = () => {
                            console.log('ğŸ¯ åœ¨çº¿è§†é¢‘å¯ä»¥æ­£å¸¸åŠ è½½ï¼');
                            this.showMessage('åœ¨çº¿è§†é¢‘é“¾æ¥æ­£å¸¸ï¼Œå¯ä»¥æ’­æ”¾', 'success');
                        };
                        video.onerror = (e) => {
                            const errorMsg = e.message || 'è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥é“¾æ¥æ˜¯å¦æœ‰æ•ˆ';
                            console.error('âŒ åœ¨çº¿è§†é¢‘åŠ è½½é”™è¯¯:', errorMsg);
                            // ä¸æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œè®©å®é™…æ’­æ”¾å™¨å¤„ç†ï¼Œé¿å…å¹²æ‰°ç”¨æˆ·ä½“éªŒ
                        };
                        
                    } catch (error) {
                        const errorMsg = error.message || 'è°ƒè¯•è¿‡ç¨‹å‡ºé”™';
                        console.error('âŒ è°ƒè¯•å¤±è´¥:', errorMsg);
                        // ä¸æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œé¿å…å¹²æ‰°ç”¨æˆ·ä½“éªŒ
                    }
                },
                
                // æ˜¾ç¤ºæ¶ˆæ¯
                showMessage(message, type) {
                    // è¿™é‡Œå¯ä»¥æ·»åŠ ä¸€ä¸ªæ¶ˆæ¯æç¤ºç»„ä»¶
                    alert(`${type === 'success' ? 'âœ…' : 'âŒ'} ${message}`);
                },
                
                // ä¿®æ”¹æ‰“å¼€è§†é¢‘æ¨¡æ€æ¡†æ–¹æ³•ï¼Œæ·»åŠ é”™è¯¯å¤„ç†
                async openVideoModal(course) {
                    console.log('ğŸ¬ å°è¯•æ‰“å¼€è§†é¢‘:', course);
                    
                    this.currentVideo = course;
                    this.showVideoModal = true;
                    
                    // ä¸å†è‡ªåŠ¨è¿è¡Œè°ƒè¯•ï¼Œé¿å…å¹²æ‰°æ­£å¸¸æ’­æ”¾
                    // å¦‚æœéœ€è¦è°ƒè¯•ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨ debugVideoFiles()
                    
                    // é‡ç½®æ’­æ”¾å™¨çŠ¶æ€
                    this.isPlaying = false;
                    this.currentTime = 0;
                    this.zoom = 1;
                    
                    // å»¶è¿Ÿåˆå§‹åŒ–æ’­æ”¾å™¨ï¼Œç¡®ä¿DOMå·²æ›´æ–°
                    this.$nextTick(() => {
                        this.initVideoPlayerWithRetry();
                    });
                },
                
                // å¢å¼ºçš„è§†é¢‘æ’­æ”¾å™¨åˆå§‹åŒ–ï¼Œå¸¦é‡è¯•æœºåˆ¶
                initVideoPlayerWithRetry() {
                    const videoPlayer = document.getElementById('video-player');
                    const videoIframe = document.getElementById('video-iframe');
                    
                    if (!videoPlayer || !videoIframe) {
                        console.error('âŒ è§†é¢‘æ’­æ”¾å™¨å…ƒç´ æœªæ‰¾åˆ°');
                        return;
                    }
                    
                    const videoUrl = this.currentVideo.videoUrl;
                    console.log('ğŸ¯ åˆå§‹åŒ–è§†é¢‘æ’­æ”¾å™¨:', videoUrl);
                    
                    // æ£€æµ‹é“¾æ¥ç±»å‹ï¼šå¦‚æœæ˜¯è§†é¢‘æ’­æ”¾é¡µé¢ï¼ˆå¦‚go.plvideo.cnï¼‰ï¼Œä½¿ç”¨iframe
                    // å¯¹äºimgtu.comçš„é“¾æ¥ï¼Œå°è¯•ç›´æ¥ä½œä¸ºè§†é¢‘æ–‡ä»¶æ’­æ”¾
                    const isVideoPage = videoUrl.includes('go.plvideo.cn') || 
                                      videoUrl.includes('/view?vid=') ||
                                      videoUrl.includes('plvideo.cn');
                    
                    // å¯¹äºimgtu.comé“¾æ¥ï¼Œå¯èƒ½éœ€è¦æ·»åŠ æ–‡ä»¶æ‰©å±•åæˆ–ç‰¹æ®Šå¤„ç†
                    let finalVideoUrl = videoUrl;
                    if (videoUrl.includes('imgtu.com') && !videoUrl.includes('.')) {
                        // å¦‚æœimgtu.comé“¾æ¥æ²¡æœ‰æ‰©å±•åï¼Œå°è¯•æ·»åŠ .mp4
                        // æ³¨æ„ï¼šè¿™å–å†³äºimgtu.comçš„å®é™…APIï¼Œå¯èƒ½éœ€è¦è°ƒæ•´
                        console.log('ğŸ“ æ£€æµ‹åˆ°imgtu.comé“¾æ¥ï¼Œå°è¯•ä½œä¸ºè§†é¢‘æ–‡ä»¶æ’­æ”¾');
                    }
                    
                    if (isVideoPage) {
                        // ä½¿ç”¨iframeæ’­æ”¾è§†é¢‘é¡µé¢
                        console.log('ğŸ“º æ£€æµ‹åˆ°è§†é¢‘æ’­æ”¾é¡µé¢ï¼Œä½¿ç”¨iframe');
                        videoPlayer.style.display = 'none';
                        videoIframe.style.display = 'block';
                        videoIframe.src = videoUrl;
                    } else {
                        // ä½¿ç”¨videoæ ‡ç­¾æ’­æ”¾ç›´æ¥è§†é¢‘æ–‡ä»¶
                        console.log('ğŸ¬ æ£€æµ‹åˆ°ç›´æ¥è§†é¢‘æ–‡ä»¶ï¼Œä½¿ç”¨videoæ ‡ç­¾');
                        videoIframe.style.display = 'none';
                        videoPlayer.style.display = 'block';
                        videoPlayer.src = finalVideoUrl;
                        
                        // æ·»åŠ è¯¦ç»†çš„äº‹ä»¶ç›‘å¬
                        videoPlayer.addEventListener('error', (e) => {
                            const error = videoPlayer.error;
                            let errorMsg = 'è§†é¢‘åŠ è½½å¤±è´¥';
                            
                            if (error) {
                                switch(error.code) {
                                    case error.MEDIA_ERR_ABORTED:
                                        errorMsg = 'è§†é¢‘åŠ è½½è¢«ä¸­æ­¢';
                                        break;
                                    case error.MEDIA_ERR_NETWORK:
                                        errorMsg = 'ç½‘ç»œé”™è¯¯ï¼Œæ— æ³•åŠ è½½è§†é¢‘ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è§†é¢‘é“¾æ¥æ˜¯å¦æœ‰æ•ˆ';
                                        break;
                                    case error.MEDIA_ERR_DECODE:
                                        errorMsg = 'è§†é¢‘è§£ç é”™è¯¯ï¼Œå¯èƒ½æ ¼å¼ä¸æ”¯æŒ';
                                        break;
                                    case error.MEDIA_ERR_SRC_NOT_SUPPORTED:
                                        errorMsg = 'è§†é¢‘æ ¼å¼ä¸æ”¯æŒæˆ–é“¾æ¥æ— æ•ˆã€‚å¦‚æœæ˜¯è§†é¢‘æ’­æ”¾é¡µé¢ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨iframeåµŒå…¥';
                                        break;
                                    default:
                                        errorMsg = `è§†é¢‘åŠ è½½é”™è¯¯ (é”™è¯¯ä»£ç : ${error.code})`;
                                }
                            }
                            
                            console.error('âŒ è§†é¢‘æ’­æ”¾é”™è¯¯:', errorMsg);
                            console.error('é”™è¯¯è¯¦æƒ…:', error);
                            console.error('è§†é¢‘URL:', finalVideoUrl);
                            
                            // æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
                            this.showMessage(errorMsg, 'error');
                            
                            // å¦‚æœæ˜¯é“¾æ¥æ ¼å¼é—®é¢˜ï¼Œå°è¯•å¤‡ç”¨æ–¹æ¡ˆ
                            if (error && error.code === error.MEDIA_ERR_SRC_NOT_SUPPORTED) {
                                this.tryAlternativeVideoSources(videoPlayer);
                            }
                        });
                        
                        videoPlayer.addEventListener('loadstart', () => {
                            console.log('ğŸ“¥ å¼€å§‹åŠ è½½è§†é¢‘...');
                        });
                        
                        videoPlayer.addEventListener('loadeddata', () => {
                            console.log('âœ… è§†é¢‘æ•°æ®åŠ è½½å®Œæˆ');
                        });
                        
                        videoPlayer.addEventListener('canplay', () => {
                            console.log('ğŸ® è§†é¢‘å¯ä»¥æ’­æ”¾');
                        });
                        
                        videoPlayer.addEventListener('stalled', () => {
                            console.log('âš ï¸ è§†é¢‘åŠ è½½åœæ»');
                        });
                        
                        videoPlayer.addEventListener('waiting', () => {
                            console.log('â³ è§†é¢‘ç­‰å¾…æ•°æ®');
                        });
                        
                        // å°è¯•åŠ è½½
                        videoPlayer.load();
                    }
                },
                
                // å°è¯•å¤‡ç”¨è§†é¢‘æº
                tryAlternativeVideoSources(videoPlayer) {
                    console.log('ğŸ”„ å°è¯•å¤‡ç”¨è§†é¢‘æº...');
                    
                    // ç”±äºç°åœ¨ä½¿ç”¨åœ¨çº¿é“¾æ¥ï¼Œå¤‡ç”¨æºä¸»è¦æ˜¯å½“å‰é“¾æ¥æœ¬èº«
                    const alternatives = [
                        this.currentVideo.videoUrl, // ä¸»è¦ä½¿ç”¨å½“å‰è§†é¢‘é“¾æ¥
                        // å¦‚æœå½“å‰é“¾æ¥æ˜¯å®Œæ•´çš„åœ¨çº¿URLï¼Œç›´æ¥ä½¿ç”¨ï¼›å¦åˆ™å°è¯•å…¶ä»–å¯èƒ½çš„æ ¼å¼
                        this.currentVideo.videoUrl.startsWith('http') ? this.currentVideo.videoUrl : null
                    ].filter(Boolean); // ç§»é™¤nullå€¼
                    
                    let currentTry = 0;
                    
                    const tryNextSource = () => {
                        if (currentTry >= alternatives.length) {
                            console.error('âŒ æ‰€æœ‰å¤‡ç”¨æºéƒ½å¤±è´¥äº†');
                            this.showMessage('æ— æ³•æ’­æ”¾è§†é¢‘ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨', 'error');
                            return;
                        }
                        
                        const altSource = alternatives[currentTry];
                        console.log(`ğŸ”„ å°è¯•å¤‡ç”¨æº ${currentTry + 1}: ${altSource}`);
                        
                        videoPlayer.src = altSource;
                        videoPlayer.load();
                        
                        currentTry++;
                        
                        // è®¾ç½®è¶…æ—¶æ£€æŸ¥
                        setTimeout(() => {
                            if (videoPlayer.error) {
                                tryNextSource();
                            }
                        }, 2000);
                    };
                    
                    tryNextSource();
                },
                
                // å…³é—­è§†é¢‘æ¨¡æ€æ¡†
                closeVideoModal() {
                    this.showVideoModal = false;
                    const videoPlayer = document.getElementById('video-player');
                    const videoIframe = document.getElementById('video-iframe');
                    
                    if (videoPlayer) {
                        videoPlayer.pause();
                        videoPlayer.src = ''; // æ¸…ç†è§†é¢‘æº
                    }
                    
                    if (videoIframe) {
                        videoIframe.src = ''; // æ¸…ç†iframeæº
                    }
                },
                
                // åˆ‡æ¢æ’­æ”¾/æš‚åœ
                togglePlayPause() {
                    const videoPlayer = document.getElementById('video-player');
                    if (videoPlayer) {
                        if (videoPlayer.paused) {
                            videoPlayer.play();
                        } else {
                            videoPlayer.pause();
                        }
                    }
                },
                
                // æ”¾å¤§è§†é¢‘
                zoomIn() {
                    if (this.zoom < 2) {
                        this.zoom += 0.1;
                        this.updateVideoZoom();
                    }
                },
                
                // ç¼©å°è§†é¢‘
                zoomOut() {
                    if (this.zoom > 0.5) {
                        this.zoom -= 0.1;
                        this.updateVideoZoom();
                    }
                },
                
                // æ›´æ–°è§†é¢‘ç¼©æ”¾
                updateVideoZoom() {
                    const videoPlayer = document.getElementById('video-player');
                    if (videoPlayer) {
                        videoPlayer.style.transform = `scale(${this.zoom})`;
                    }
                },
                
                // åˆ‡æ¢å…¨å±
                toggleFullscreen() {
                    const videoModal = document.getElementById('video-modal');
                    if (!document.fullscreenElement) {
                        if (videoModal.requestFullscreen) {
                            videoModal.requestFullscreen();
                        }
                    } else {
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        }
                    }
                },
                
                // æ ¼å¼åŒ–æ—¶é—´
                formatTime(seconds) {
                    const mins = Math.floor(seconds / 60);
                    const secs = Math.floor(seconds % 60);
                    return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
                },
                
                // è¿›å…¥è™šæ‹Ÿåœºæ™¯
                enterVirtualScene() {
                    // æŸ¥æ‰¾é€‚åˆå½“å‰è§†é¢‘çš„è™šæ‹Ÿåœºæ™¯
                    const suitableScene = this.virtualScenes.find(scene => 
                        scene.videoIds.includes(this.currentVideo.id)
                    ) || this.virtualScenes[0];
                    
                    this.currentScene = suitableScene;
                    this.showVideoModal = false;
                    this.showVirtualSceneModal = true;
                    
                    // å»¶è¿Ÿåˆå§‹åŒ–åœºæ™¯è§†é¢‘æ’­æ”¾å™¨
                    this.$nextTick(() => {
                        const sceneVideo = document.querySelector('.scene-video-player');
                        if (sceneVideo) {
                            sceneVideo.play();
                            this.isSceneVideoPlaying = true;
                        }
                    });
                },
                
                // æ‰“å¼€è™šæ‹Ÿåœºæ™¯
                openVirtualScene(scene) {
                    this.currentScene = scene;
                    this.showVirtualSceneModal = true;
                    
                    // å»¶è¿Ÿåˆå§‹åŒ–åœºæ™¯è§†é¢‘æ’­æ”¾å™¨
                    this.$nextTick(() => {
                        const sceneVideo = document.querySelector('.scene-video-player');
                        if (sceneVideo) {
                            sceneVideo.play();
                            this.isSceneVideoPlaying = true;
                        }
                    });
                },
                
                // å…³é—­è™šæ‹Ÿåœºæ™¯æ¨¡æ€æ¡†
                closeVirtualSceneModal() {
                    this.showVirtualSceneModal = false;
                    const sceneVideo = document.querySelector('.scene-video-player');
                    if (sceneVideo) {
                        sceneVideo.pause();
                    }
                },
                
                // é€€å‡ºè™šæ‹Ÿåœºæ™¯
                exitVirtualScene() {
                    this.closeVirtualSceneModal();
                    this.showVideoModal = true;
                },
                
                // åˆ‡æ¢åœºæ™¯è§†é¢‘æ’­æ”¾çŠ¶æ€
                toggleSceneVideoPlay() {
                    const sceneVideo = document.querySelector('.scene-video-player');
                    if (sceneVideo) {
                        if (sceneVideo.paused) {
                            sceneVideo.play();
                            this.isSceneVideoPlaying = true;
                        } else {
                            sceneVideo.pause();
                            this.isSceneVideoPlaying = false;
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>